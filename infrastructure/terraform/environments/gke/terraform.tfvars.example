# =============================================================================
# Orbit GKE Environment - Example Configuration
# =============================================================================
# Copy this file to terraform.tfvars and update with your values.
# =============================================================================

# -----------------------------------------------------------------------------
# Required Variables
# -----------------------------------------------------------------------------
project_id   = "your-gcp-project-id"
project_name = "orbit"
region       = "us-central1"

# -----------------------------------------------------------------------------
# VPC Configuration
# -----------------------------------------------------------------------------
# vpc_subnet_cidr   = "10.0.0.0/20"
# vpc_pods_cidr     = "10.16.0.0/14"
# vpc_services_cidr = "10.20.0.0/20"

# -----------------------------------------------------------------------------
# GKE Cluster Configuration
# -----------------------------------------------------------------------------
regional_cluster        = true
enable_private_nodes    = true
enable_private_endpoint = false
# master_ipv4_cidr_block = "172.16.0.0/28"

# Uncomment to restrict master access to specific networks
# master_authorized_networks = [
#   {
#     cidr_block   = "10.0.0.0/8"
#     display_name = "VPC"
#   },
#   {
#     cidr_block   = "YOUR_IP/32"
#     display_name = "Office"
#   }
# ]

kubernetes_version_prefix = "1.28."
release_channel           = "REGULAR"

node_pools = {
  default = {
    initial_node_count = 1
    min_node_count     = 1
    max_node_count     = 5
    enable_autoscaling = true
    machine_type       = "e2-standard-2"
    disk_size_gb       = 100
    disk_type          = "pd-standard"
    preemptible        = false
    spot               = false
  }
  # Uncomment for a second node pool with spot instances
  # spot = {
  #   initial_node_count = 0
  #   min_node_count     = 0
  #   max_node_count     = 10
  #   enable_autoscaling = true
  #   machine_type       = "e2-standard-2"
  #   spot               = true
  #   taints = [
  #     {
  #       key    = "spot"
  #       value  = "true"
  #       effect = "NO_SCHEDULE"
  #     }
  #   ]
  # }
}

enable_network_policy = true

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
database_version           = "POSTGRES_15"
database_tier              = "db-custom-1-3840"  # 1 vCPU, 3.75 GB RAM
database_availability_type = "REGIONAL"
database_disk_size         = 20
database_name              = "orbit"
database_user              = "orbit"
# database_password        = ""  # Leave empty for auto-generation

database_backup_enabled         = true
database_point_in_time_recovery = true

# -----------------------------------------------------------------------------
# Kubernetes Addons
# -----------------------------------------------------------------------------
enable_nginx_ingress       = true
nginx_replica_count        = 2
enable_cert_manager        = true
create_letsencrypt_issuers = true
letsencrypt_email          = "admin@example.com"

# -----------------------------------------------------------------------------
# Orbit Application
# -----------------------------------------------------------------------------
orbit_namespace = "orbit"
# orbit_chart_path = "../../../helm/orbit"

backend_replica_count    = 2
backend_image_repository = "ghcr.io/your-org/orbit-backend"
backend_image_tag        = "latest"
# backend_resources = {
#   requests = {
#     memory = "256Mi"
#     cpu    = "100m"
#   }
#   limits = {
#     memory = "512Mi"
#     cpu    = "500m"
#   }
# }

frontend_replica_count    = 2
frontend_image_repository = "ghcr.io/your-org/orbit-frontend"
frontend_image_tag        = "latest"

ingress_enabled         = true
ingress_host            = "orbit.yourdomain.com"
ingress_tls_enabled     = true
ingress_tls_secret_name = "orbit-tls"
cert_manager_issuer     = "letsencrypt-prod"

# Uncomment if using Workload Identity
# workload_identity_sa = "orbit-sa@your-project.iam.gserviceaccount.com"

# -----------------------------------------------------------------------------
# Labels & Protection
# -----------------------------------------------------------------------------
labels = {
  environment = "production"
  application = "orbit"
  managed-by  = "terraform"
}

# Set to false to allow terraform destroy
deletion_protection = true
