# =============================================================================
# Orbit Helm Chart - Default Values
# =============================================================================
# This file contains the default configuration values for the Orbit Helm chart.
# Override these values by creating your own values file:
#   helm install orbit ./helm/orbit -f my-values.yaml
# =============================================================================

# -----------------------------------------------------------------------------
# Global Settings
# -----------------------------------------------------------------------------
global:
  # Image pull secrets for private registries
  imagePullSecrets: []
  # Storage class for persistent volumes (leave empty for default)
  storageClass: ""

# -----------------------------------------------------------------------------
# Backend Configuration
# -----------------------------------------------------------------------------
backend:
  replicaCount: 1

  image:
    repository: ghcr.io/your-org/orbit-backend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to Chart appVersion

  service:
    type: ClusterIP
    port: 8000

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  # Environment variables
  env:
    DEBUG: "false"
    TASK_ID_PREFIX: "ORBIT"

  # Sensitive values - override in your values file or use existingSecret
  secrets:
    secretKey: ""  # Auto-generated if empty
    # Use existing secret instead of creating new one
    existingSecret: ""
    # Keys in the existing secret
    secretKeyKey: "SECRET_KEY"

  # Health check configuration
  livenessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  # Pod configuration
  podAnnotations: {}
  podSecurityContext: {}
  securityContext: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

  # Autoscaling
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

# -----------------------------------------------------------------------------
# Frontend Configuration
# -----------------------------------------------------------------------------
frontend:
  replicaCount: 1

  image:
    repository: ghcr.io/your-org/orbit-frontend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to Chart appVersion

  service:
    type: ClusterIP
    port: 80

  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "200m"

  # Health check configuration
  livenessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  # Pod configuration
  podAnnotations: {}
  podSecurityContext: {}
  securityContext: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

  # Autoscaling
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80

# -----------------------------------------------------------------------------
# Ingress Configuration
# -----------------------------------------------------------------------------
ingress:
  enabled: true
  className: "nginx"  # or "traefik", "alb", etc.
  annotations: {}
    # kubernetes.io/tls-acme: "true"
    # cert-manager.io/cluster-issuer: "letsencrypt-prod"

  # Hostname for the ingress
  host: orbit.example.com

  # TLS configuration
  tls:
    enabled: false
    secretName: orbit-tls

  # Path configuration
  paths:
    frontend: /
    api: /api
    health: /health

# -----------------------------------------------------------------------------
# PostgreSQL Configuration (Bitnami subchart)
# -----------------------------------------------------------------------------
postgresql:
  enabled: true

  auth:
    username: orbit
    password: ""  # Auto-generated if empty
    database: orbit
    existingSecret: ""
    secretKeys:
      adminPasswordKey: postgres-password
      userPasswordKey: password

  primary:
    persistence:
      enabled: true
      size: 8Gi
      storageClass: ""

    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"

# -----------------------------------------------------------------------------
# External Database Configuration
# -----------------------------------------------------------------------------
# Use this instead of the built-in PostgreSQL
externalDatabase:
  enabled: false
  host: ""
  port: 5432
  database: orbit
  username: orbit
  password: ""
  existingSecret: ""
  existingSecretPasswordKey: "password"

# -----------------------------------------------------------------------------
# Service Account
# -----------------------------------------------------------------------------
serviceAccount:
  create: true
  annotations: {}
  name: ""

# -----------------------------------------------------------------------------
# Network Policies
# -----------------------------------------------------------------------------
networkPolicy:
  enabled: false

# -----------------------------------------------------------------------------
# Pod Disruption Budget
# -----------------------------------------------------------------------------
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1
